<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChartSpec Workbench - Data Visualization Workspace</title>
  
  <!-- CSS Tokens and Styles -->
  <link rel="stylesheet" href="./styles/tokens.css">
  <link rel="stylesheet" href="./styles/app.css">
  <link rel="stylesheet" href="./styles/components.css">
  
  <script>
    (function() {
      if (window.__TEST_MODE__) {
        const d3Script = document.createElement('script');
        d3Script.src = './vendor/d3.v7.min.js';
        document.head.appendChild(d3Script);
        return;
      }
      const gridCss = document.createElement('link');
      gridCss.rel = 'stylesheet';
      gridCss.href = 'https://cdn.jsdelivr.net/npm/gridstack@10.3.1/dist/gridstack.min.css';
      gridCss.onerror = () => console.warn('Gridstack CSS failed to load from CDN');
      document.head.appendChild(gridCss);

      const plotlyScript = document.createElement('script');
      plotlyScript.src = 'https://cdn.jsdelivr.net/npm/plotly.js-dist@2.27.0/plotly.min.js';
      document.head.appendChild(plotlyScript);

      const d3Script = document.createElement('script');
      d3Script.src = 'https://d3js.org/d3.v7.min.js';
      d3Script.onerror = () => {
        const fallback = document.createElement('script');
        fallback.src = './vendor/d3.v7.min.js';
        document.head.appendChild(fallback);
      };
      document.head.appendChild(d3Script);

      const avaScript = document.createElement('script');
      avaScript.src = 'https://unpkg.com/@antv/ava@latest/dist/index.min.js';
      document.head.appendChild(avaScript);

      const gridScript = document.createElement('script');
      gridScript.src = 'https://cdn.jsdelivr.net/npm/gridstack@10.3.1/dist/gridstack-all.js';
      document.head.appendChild(gridScript);
    })();
  </script>
  
  <!-- Split.js for resizable panels (optional, inline fallback) -->
  <script>
    // Minimal Split.js polyfill for resizable drawer
    // Real Split.js would be loaded from CDN or vendor
    window.Split = window.Split || function() {
      console.warn('Split.js not loaded, using basic resize');
      return { setSizes: () => {}, destroy: () => {} };
    };
  </script>
</head>
<body>
  <!-- App Shell - Main Layout Container -->
  <cs-app-shell></cs-app-shell>
  
  <!-- Load application as ES module -->
  <script type="module" src="./workbench/main.js"></script>
</body>
</html>
